NOTEs for booting TRDOS 386 from
Extended DOS partition (logical dos drives)
via Linux GRUB... (for MBR partition tables, not for EFI boot)

1) FAT or FAT32 logical dos drives must be recognized by Grub (configurator).
2) Default Windows (FAT&FAT32 fs) boot sectors must be replaced with
   TRDOS 386 FAT16 (1 sector) and/or FAT32 boot sectors (2 sectors, 0 and 2)
   by keeping bootsector parameters (BPB) as unchanged
   (this can be done via a binary file editor, hex editor which can modify
   logical disk boot sectors).
3) 'Hidden Sectors' field of the logical drive's boot sector contains
   hidden sector from start of extended partition not from start of the disk.
   So, 'hidden sectors' field must be modified by using exact boot sector
   address (LBA from start of the physical disk).
4) GNU Grub boot configuration (/boot/grub/grub.cfg) file must be
   edited for ensuring:
   -linux type logical dos drive names (sda5, sda6 etc) must be used correctly  
   -volume ids must be used correctly (as written on volume boot sector) 
   -grub menu entries must be chaned properly by only changing order and disk
    drive names and volume ids not for else..
5) Windows system partition has own menu to select a windows logical disk to
   boot. So, only Windows system partition (NTFS) must be used for Grub menu.
   (Remove repetitive Grub menu row which launches same Windows boot menu.)


Manual modification on TRDOS 386 boot sectors:

Even if the source code contains CHS-LBA type diskio tricks...
.. current TRDOS 386 boot sector images/templates (for FAT16 and FAT32 fs)
are fixed for CHS type dos partition. (but possible to modify it easly). 
At the beyond of CHS limit... (commonly in extended dos partition)..
LBA trick must be applied manually (for now).

* For FAT16 fs: boot sector offset 3Eh (04h, 00h) must be changed to
                0Eh, 07h
* For FAT32 fs: boot sector offset 5Ah (0Bh, C0h) must be changed to
                0Ch, 00h



23/01/2026
